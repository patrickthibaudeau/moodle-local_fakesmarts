{"version":3,"file":"minutes_maker.min.js","sources":["../src/minutes_maker.js"],"sourcesContent":["import $ from 'jquery';\nimport ajax from 'core/ajax';\nimport config from 'core/config';\n\nexport const init = () => {\n    get_response();\n};\n\n/**\n * Delete a content\n */\nfunction get_response() {\n\n    $(\"#process-notes\").off();\n    $(\"#process-notes\").on('click', function () {\n        $('#fakesmarts-cost').hide();\n        var bot_id = $(this).data('bot_id');\n        var language = $('#language').val();\n        var content  = $('#notes').val();\n        var chat_id = $('#fakesmarts-chat-id').val();\n        var prompt = `Create meeting notes and separate the notes by topic. Each topic should be in a \n        numbered list. Once done, create all action items from transcription. Format the action items as a list having \n        the following headings: Assigned to, Description, Date due`;\n        if (language == 'fr') {\n            prompt = `Créez des notes de réunion et séparez les notes par sujet. Chaque sujet doit être dans une \n            liste numérotée. Une fois terminé, créez toutes les tâches à partir de la transcription. Formatez les \n            tâches comme une list ayant les entêtes suivantes: Assigné à, Description, Date d'échéance`;\n        }\n                    // Get all values from various fields\n        var project_name = $('#project_name').val();\n        var date = $('#date').val();\n        var time = $('#time').val();\n        var location = $('#location').val();\n\n        $('#process-notes').hide();\n    $('#starting-process').show();\n\n        //Delete the record\n        var gpt_response = ajax.call([{\n            methodname: 'fakesmarts_get_gpt_response',\n            args: {\n                bot_id: bot_id,\n                chat_id: chat_id,\n                prompt: prompt,\n                content: content\n            }\n        }]);\n\n        gpt_response[0].done(function (result) {\n            console.log(result);\n            let data = JSON.parse(result);\n                    let form_data = {\n                        'project_name': project_name,\n                        'date': date,\n                        'time': time,\n                        'location': location,\n                        'minutes': data.message\n                    };\nconsole.log(form_data);\n            $('#starting-process').hide();\n            $('#almost-done').show();\n            // JQuery Ajax call to process.php\n            setTimeout(function () {\n                $('#almost-done').hide();\n                $('#process-complete').show();\n                $.post(config.wwwroot + \"/local/fakesmarts/minutes_master/process.php\", form_data, function (response) {\n                    console.log(response);\n                    let path_data = JSON.parse(response);\n                    window.location.href = config.wwwroot + \"/local/fakesmarts/minutes_master/download.php?path=\"\n                        + path_data.path + \"&file=\" + path_data.file_name;\n                    setTimeout(function () {\n                        $('#fakesmarts-cost').show();\n                        $('#fakesmarts-cost').html('$' + data.cost.toPrecision(6));\n                        $('#process-complete').hide();\n                        $('#process-notes').show();\n                    }, 1500);\n                });\n            }, 2000);\n\n\n            $('#fakesmarts-message').html(data.message);\n            // $('#fakesmarts-prompt-tokens').html(data.prompt_tokens);\n            // $('#fakesmarts-completion-tokens').html(data.completion_tokens);\n            // $('#fakesmarts-total-tokens').html(data.total_tokens);\n\n        }).fail(function () {\n            alert('An error has occurred.');\n        });\n    });\n}"],"names":["off","on","hide","bot_id","this","data","language","val","content","chat_id","prompt","project_name","date","time","location","show","ajax","call","methodname","args","done","result","console","log","JSON","parse","form_data","message","setTimeout","post","config","wwwroot","response","path_data","window","href","path","file_name","html","cost","toPrecision","fail","alert"],"mappings":"kaAIoB,yBASd,kBAAkBA,0BAClB,kBAAkBC,GAAG,SAAS,+BAC1B,oBAAoBC,WAClBC,QAAS,mBAAEC,MAAMC,KAAK,UACtBC,UAAW,mBAAE,aAAaC,MAC1BC,SAAW,mBAAE,UAAUD,MACvBE,SAAU,mBAAE,uBAAuBF,MACnCG,uRAGY,MAAZJ,WACAI,sUAKAC,cAAe,mBAAE,iBAAiBJ,MAClCK,MAAO,mBAAE,SAASL,MAClBM,MAAO,mBAAE,SAASN,MAClBO,UAAW,mBAAE,aAAaP,0BAE5B,kBAAkBL,2BACtB,qBAAqBa,OAGAC,cAAKC,KAAK,CAAC,CAC1BC,WAAY,8BACZC,KAAM,CACFhB,OAAQA,OACRM,QAASA,QACTC,OAAQA,OACRF,QAASA,YAIJ,GAAGY,MAAK,SAAUC,QAC3BC,QAAQC,IAAIF,YACRhB,KAAOmB,KAAKC,MAAMJ,QACVK,UAAY,cACIf,kBACRC,UACAC,cACIC,iBACDT,KAAKsB,SAExCL,QAAQC,IAAIG,+BACE,qBAAqBxB,2BACrB,gBAAgBa,OAElBa,YAAW,+BACL,gBAAgB1B,2BAChB,qBAAqBa,uBACrBc,KAAKC,gBAAOC,QAAU,+CAAgDL,WAAW,SAAUM,UACzFV,QAAQC,IAAIS,cACRC,UAAYT,KAAKC,MAAMO,UAC3BE,OAAOpB,SAASqB,KAAOL,gBAAOC,QAAU,sDAClCE,UAAUG,KAAO,SAAWH,UAAUI,UAC5CT,YAAW,+BACL,oBAAoBb,2BACpB,oBAAoBuB,KAAK,IAAMjC,KAAKkC,KAAKC,YAAY,wBACrD,qBAAqBtC,2BACrB,kBAAkBa,SACrB,WAER,yBAGD,uBAAuBuB,KAAKjC,KAAKsB,YAKpCc,MAAK,WACJC,MAAM"}